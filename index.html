<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>d3 Heatmap</title>

  <!-- load d3.js -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script> const div = d3.selectAll("div");</script>
</head>

<body>

  <!-- upload csv file -->
  <input id="input" type="file" accept=".csv">

  <div id="buttons"></div> <br>

  <!-- graph will take place here -->
  <div id="graph"></div>

  <script>
    // set the dimensions and margins of the graph
    var margin = { top: 80, right: 25, bottom: 30, left: 40 },
      width = 450,
      height = 450;

    // append the svg object to the body of the page
    var svg = d3.select("#graph")
      .append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform",
        "translate(" + margin.left + "," + margin.top + ")");

    //handle input csv file
    var input = document.getElementById("input");
    input.onchange = function () {
      var fileList = input.files;

      //file read as text
      var reader = new FileReader();
      reader.readAsText(fileList[0]);

      //after file loaded
      var data;
      reader.onload = function () {
        data = d3.csvParse(reader.result, d3.autoType);

        //make buttons to select graph option
        var buttons = document.getElementById("buttons");

        //draw xz graph
        var option1 = document.createElement("button");
        option1.innerHTML = "XZ";
        option1.addEventListener("click", () => {
          drawGraph();
        })
        buttons.appendChild(option1);

        var option2 = document.createElement("button");
        option2.innerHTML = "YZ";
        option2.addEventListener("click", () => {
          drawGraph();
        })
        buttons.appendChild(option2);

        var option3 = document.createElement("button");
        option3.innerHTML = "heatmap";
        option3.addEventListener("click", () => {
          drawGraph();
        })
        buttons.appendChild(option3);
      };


      //우선은 x, y 범위가 0~10이라고 가정
      function drawGraph() {
        // Build X scales and axis:
        var x = d3.scaleLinear()
          .domain([0, 10])
          .range([margin.left, width - margin.right])

        xAxis = g => g
          .attr("transform", `translate(0,${height - margin.bottom})`)
          .call(d3.axisBottom(x))

        svg.append("g")
          .call(xAxis)


        // Build Y scales and axis:
        var y = d3.scaleLinear()
          .domain([0, 10])
          .range([height - margin.bottom, margin.top])

        yAxis = g => g
          .attr("transform", `translate(${margin.left},0)`)
          .call(d3.axisLeft(y))

        svg.append("g")
          .call(yAxis);

        // Build color scale
        var myColor = d3.scaleSequential()
          .interpolator(d3.interpolateInferno)
          .domain([1, 100])

        // add the squares


      };
    }
  </script>

</body>

</html>