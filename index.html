<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>d3.heatmap</title>
</head>

<body>
  <div id="options"></div>

  <!-- graph will take place here -->
  <div id="graph"></div>

  <script type="module">
    import * as d3 from "https://cdn.skypack.dev/d3@7";
    import { heatmap } from "./src/heatmap.js";

    const div = d3.selectAll("div");

    // set the dimensions and margins of the graph
    const margin = { top: 10, right: 30, bottom: 30, left: 40 },
      width = 660 - margin.left - margin.right,
      height = 400 - margin.top - margin.bottom;

    const svg = d3.select("#graph");

    // read local json file
    let object;
    let httpRequest = new XMLHttpRequest(); // asynchronous request
    httpRequest.open("GET", "./result.json", true);
    httpRequest.send();
    httpRequest.addEventListener("readystatechange", function () {
      if (this.readyState === this.DONE) {
        // when the request has completed
        object = JSON.parse(this.response);

        let options = document.getElementById("options");

        let heatmapButton = document.createElement("button");
        heatmapButton.innerHTML = "Generate Heatmap";
        heatmapButton.addEventListener("click", () => {
          svg.append(() => heatmap(object, 1000000, 250));
        });
        options.appendChild(heatmapButton);
      }
    });


  </script>

</body>

</html>