<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <title>d3.heatmap</title>
</head>

<body>
  <div id="options">
    <label for="optionX">X축</label>
    <select id="optionX">
      <option value=trainable_parameters selected="selected"># of trainable parameters</option>
      <option value=training_time>training time</option>
      <option value=test_accuracy>accuracy</option>
    </select>
    <label for="optionY">Y축</label>
    <select id="optionY">
      <option value=trainable_parameters># of trainable parameters</option>
      <option value=training_time selected="selected">training time</option>
      <option value=test_accuracy>accuracy</option>
    </select>
    <label for="optionZ">Z축</label>
    <select id="optionZ">
      <option value=trainable_parameters># of trainable parameters</option>
      <option value=training_time>training time</option>
      <option value=test_accuracy selected="selected">accuracy</option>
    </select><br>
  </div>

  <!-- graph will take place here -->
  <div id="graph"></div>

  <script type="module">
    import * as d3 from "https://cdn.skypack.dev/d3@7";
    import { heatmap } from "./src/heatmap.js";

    const div = d3.selectAll("div");
    const svg = d3.select("#graph");

    // read local json file
    let data;
    let httpRequest = new XMLHttpRequest(); // asynchronous request
    httpRequest.open("GET", "./result.json", true);
    httpRequest.send();
    httpRequest.addEventListener("readystatechange", function () {
      if (this.readyState === this.DONE) { // when the request has completed
        data = JSON.parse(this.response);

        let options = document.getElementById("options");

        let heatmapButton = document.createElement("button");
        heatmapButton.innerHTML = "Generate Heatmap";
        heatmapButton.addEventListener("click", () => {
          let optionX = document.getElementById("optionX"),
            optionY = document.getElementById("optionY"),
            optionZ = document.getElementById("optionZ");
          svg.append(() => heatmap()
            .x(d => d[optionX.value])
            .y(d => d[optionY.value])
            .z(d => d[optionZ.value])
            .splitX(100)
            .splitY(50)
            (data));
        });
        options.appendChild(heatmapButton);
      }
    });


  </script>
</body>

</html>